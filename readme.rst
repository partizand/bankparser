==============
bankparser
==============

Преобразование файлов выписок от банков в qif формат.
Создан для работы с GnuCash, т.к. GnuCash не умеет импортировать выписки ofx с символами Unicode.

Пока тестовая версия

Установка
---------

Используется Python 3

Зайти в каталог с исходниками::

  python setup.py install

Использование
-------------
::

 bankparser bank_name in_file_name [--outfile out_file_name]

bank_name
  Имя банка - это имя ini файла с настройками банка

in_file_name
  Имя обрабатываемого файла из банка

out_file_name
  Имя сформированного файла (опционально)

Настроенные банки
-----------------

* ВТБ24 - vtb24.ini (http://vtb24.ru)

* Alfadirect (http://alfadirect.ru)

  - отчет о движени бумаг  - adshares.ini

.. banks_start


.. banks_finish


---------------
Настройка банка
---------------

Для настройки на свой банк создайте ini файл с именем банка. Bank_name.ini.
В секции common укажите общие настройки

.. commons_start

Описание настроек секции [common]: 

delimiter
   Разделитель полей. По умолчанию: ';'
encoding
   Кодировка файла. По умолчанию: 'utf-8'
startafter
   Начинать разбор строк со следующей, после стоки начинающейся с указанных символов. По умолчанию: None
type
   Тип выписки: Bank или Invst (обычная или операции с ценными бумагами). По умолчанию: 'Bank'
fields
   Обязательное поле. Имена полей в файле через пробел, нужные поля должны совпадать с именем в описанни доступных полей
dateformat
   Формат даты в банковском файле. По умолчанию: '%Y-%m-%d %H:%M:%S'
banksite
   Ссылка на сайт банка. По умолчанию: None
bankname
   Название банка. По умолчанию: None

.. commons_finish

accounts
^^^^^^^^

Возможно добавить секци. [accounts]
Для замены счета из выписки на имя счета (например для GnuCash)

::

 [accounts]
 40817=Имя счета

actions
^^^^^^^

Секция [actions] используется для настройки под операции с ценными бумагами.
Подменяет название операции (покупка, продажа) на стандартные названия buy и sell

::

  [actions]
  Покупка=buy
  Продажа=sell

Поля в выписке
--------------

Должны быть указаны все поля в выписке в параметре fields в секции [common] банка через пробел.
Нужные имена полей должны совпадать с нижеописанными. Если поле не нужно обрабатывать присвойте ему любое
другое имя

.. fields_start

Описание полей: 

date
   Дата проводки. Тип поля: date
account
   Счет. Тип поля: string
amount
   Сумма. Тип поля: float
description
   Описание. Тип поля: string
action
   Операция (для ценных бумаг): buy, sell. Тип поля: string
securityname
   Имя ценной бумаги. Тип поля: string
price
   Цена (для ценных бумаг). Тип поля: float
quantity
   Количество бумаг . Тип поля: float
commission
   Комиссия (для ценных бумаг). Тип поля: float

.. fields_finish

setup notes
-----------

Некоторые файлы и часть справки генерятся автоматом из buil.py

::

  fields.csv -> statementline.py
             -> qifline.py
             -> readme.rst (.. fields_start  .. fields_finish)

  commons.csv -> confcommons.py
              -> readme.rst (.. commons_start  .. commons_finish)

Для добавления обработки поля выписки его просто нужно добавить в файл fields.csv

Для добавления общей настройки банка его нужно добавить в файл commons.csv. Правда имена полей в последующем
вызываются из кода не привязанного к commons.csv


Лицензия
--------

GNU GPL 3

Автор
-----

Andrey Kapustin